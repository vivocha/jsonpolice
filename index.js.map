{"version":3,"sources":["src/index.js"],"names":[],"mappings":"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","file":"index.js","sourcesContent":["'use strict';\n\nvar __sym = Symbol();\n\nfunction defined(v) {\n   return typeof v !== 'undefined';\n}\n\nclass DataError extends Error {\n  constructor(name, path) {\n    super(name);\n    this.name = 'DataError';\n    this.path = path;\n  }\n}\n\nclass InitError extends Error {\n  constructor(value, errors) {\n    super();\n    this.name = 'InitError';\n    this.value = value;\n    this.errors = errors;\n  }\n}\n\nclass Property {\n  constructor(config, value, parent, key, errors) {\n    this.config = Property.getConfig(config);\n    if (defined(parent) && defined(key)) {\n      this.attach(parent, key);\n    }\n    this.setValue(defined(value) ? value : this.config.default, errors);\n  }\n  attach(parent, key) {\n    this.detach();\n    if (defined(parent) && defined(key)) {\n      this.parent = parent;\n      this.key = key;\n      Object.defineProperty(this.parent, this.key, {\n        configurable: !this.config.required,\n        enumerable: true,\n        get: this.getter(),\n        set: this.setter()\n      });\n    }\n  }\n  detach() {\n    if (defined(this.key) && defined(this.parent)) {\n      delete this.parent[this.key];\n    }\n    delete this.key;\n    delete this.parent;\n  }\n  dataError(type, sink) {\n    var e = new DataError(type, this.getPath());\n    if (sink) {\n      sink.push(e);\n    } else {\n      throw e;\n    }\n  }\n  check(v) {\n    if (!defined(v) && this.config.required) {\n      this.dataError('required');\n    }\n    if (this.config.validator && !this.config.validator(v, this)) {\n      this.dataError('validator');\n    }\n  }\n  init(v, errors) {\n    this.check(v);\n  }\n  getter() {\n    var f = this.getValue.bind(this);\n    f.config = this.config;\n    return f;\n  }\n  getValue() {\n    this.check(this.value);\n    return this.value;\n  }\n  setter() {\n    var f = this.setValue.bind(this);\n    f.config = this.config;\n    return f;\n  }\n  setValue(v, errors) {\n    try {\n      this.init(v, errors);\n    } catch(e) {\n      if (errors) {\n        errors.push(e);\n      } else {\n        throw e;\n      }\n    }\n    return this.value = v;\n  }\n  getPath() {\n    var p = '';\n    if (this.parent && this.key) {\n      if (this.parent[__sym]) {\n        p = this.parent[__sym].getPath();\n      }\n      p += (p ? '.' : '') + this.key;\n    }\n    return p;\n  }\n  meta(key) {\n    if (key) {\n      var desc = Object.getOwnPropertyDescriptor(this.value, key);\n      return ((desc || {}).get || {}).config;\n    } else {\n      return this.config;\n    }\n  }\n  static registerType(type, config) {\n    if (!Property.types) Property.types = {};\n    config.name = type;\n    Property.types[type] = config;\n  }\n  static getConfig(typeOrConfig) {\n    if (!Property.types) Property.types = {};\n    var config = null;\n    if (typeOrConfig) {\n      if (typeof typeOrConfig === 'string') {\n        config = Property.types[typeOrConfig];\n      } else if (typeof typeOrConfig === 'object') {\n        config = typeOrConfig;\n      }\n    }\n    if (!config) {\n      throw new Error('bad_config');\n    }\n    return config;\n  }\n  static create(typeOrConfig, value, parent, key, errors) {\n    var factories = {\n      \"string\": StringProperty,\n      \"number\": NumberProperty,\n      \"boolean\": BooleanProperty,\n      \"array\": ArrayProperty,\n      \"date\": DateProperty,\n      \"select\": SelectProperty,\n      \"object\": ObjectProperty\n    };\n    var config = Property.getConfig(typeOrConfig);\n    if (!factories[config.type]) {\n      throw new Error('bad_type');\n    }\n    return new factories[config.type](config, value, parent, key, errors);\n  }\n}\n\nclass StringProperty extends Property {\n  constructor(config, value, parent, key, errors) {\n    super(config, value, parent, key, errors);\n    if (defined(this.config.pattern)) {\n      if (typeof this.config.pattern === 'string') {\n        this.config.pattern = new RegExp(this.config.pattern);\n      } else if (!(this.config.patten instanceof RegExp)) {\n        throw new Error('bad_pattern');\n      }\n    }\n  }\n  check(v) {\n    if (defined(v) && typeof v !== 'string') {\n      this.dataError('type');\n    }\n    super.check(v);\n    if (defined(v)) {\n      if (defined(this.config.minLength) && v.length < +this.config.minLength) {\n        this.dataError('minLength');\n      }\n      if (defined(this.config.maxLength) && v.length > +this.config.maxLength) {\n        this.dataError('maxLength');\n      }\n      if (defined(this.config.pattern) && !this.config.pattern.test(v)) {\n        this.dataError('pattern');\n      }\n    }\n  }\n}\n\nclass NumberProperty extends Property {\n  constructor(config, value, parent, key, errors) {\n    super(config, value, parent, key, errors);\n  }\n  check(v) {\n    if (defined(v) && typeof v !== 'number') {\n      this.dataError('type');\n    }\n    super.check(v);\n    if (defined(v)) {\n      if (defined(this.config.min) && !(v >= +this.config.min)) {\n        this.dataError('min');\n      }\n      if (defined(this.config.max) && !(v <= +this.config.max)) {\n        this.dataError('max');\n      }\n    }\n  }\n}\n\nclass BooleanProperty extends Property {\n  constructor(config, value, parent, key, errors) {\n    super(config, value, parent, key, errors);\n  }\n  check(v) {\n    if (defined(v) && typeof v !== 'boolean') {\n      this.dataError('type');\n    }\n    super.check(v);\n  }\n}\n\nclass ArrayProperty extends Property {\n  constructor(config, value, parent, key, errors) {\n    super(config, value, parent, key, errors);\n    this.config.value = Property.getConfig(this.config.value);\n  }\n  init(v, errors) {\n    this.check(v);\n    if (!defined(v) || v[__sym] === this) return;\n    v[__sym] = this;\n    for (var i = 0, p ; i < v.length ; i++) {\n      p = Property.create(this.config.value, v[i], v, i, errors);\n    }\n    v.push = (...args) => {\n      for (var i = 0 ; i < args.length ; i++) {\n        p = Property.create(this.config.value, args[i], v, v.length);\n      }\n    }\n  }\n  check(v) {\n    if (defined(v) && typeof v !== 'object' && !(v instanceof Array)) {\n      this.dataError('type');\n    }\n    super.check(v);\n    if (defined(v)) {\n      if (defined(this.config.minLength) && v.length < +this.config.minLength) {\n        this.dataError('minLength');\n      }\n      if (defined(this.config.maxLength) && v.length > +this.config.maxLength) {\n        this.dataError('maxLength');\n      }\n    }\n  }\n}\n\nclass DateProperty extends Property {\n  constructor(config, value, parent, key, errors) {\n    super(config, value, parent, key, errors);\n  }\n  setValue(v) {\n    var _v = v;\n    if (defined(_v) && !(_v instanceof Date)) _v = new Date(v);\n    super.setValue(v);\n  }\n}\n\nclass SelectProperty extends Property {\n  constructor(config, value, parent, key, errors) {\n    super(config, value, parent, key, errors);\n    if (!(this.config.value instanceof Array) || !this.config.value.length) {\n      throw new Error('bad_value');\n    }\n  }\n  check(v) {\n    super.check(v);\n    if (this.config.value.indexOf(v) === -1) {\n      this.dataError('value');\n    }\n  }\n}\n\nclass ObjectProperty extends Property {\n  constructor(config, value, parent, key, errors) {\n    super(config, value, parent, key, errors);\n  }\n  init(v, errors) {\n    this.check(v);\n    if (!defined(v) || v[__sym] === this) return;\n    v[__sym] = this;\n    var k, p, sub = this.config.value || {};\n    for (k in sub) {\n      sub[k] = Property.getConfig(sub[k]);\n      p = Property.create(sub[k], v[k], v, k, errors);\n    }\n  }\n  check(v) {\n    if (defined(v) && typeof v !== 'object') {\n      this.dataError('type');\n    }\n    super.check(v);\n  }\n}\n\nexport function create(typeOrConfig, value, parent, key) {\n  return Property.create(typeOrConfig, value || {}, parent, key).value;\n}\nexport function safeCreate(typeOrConfig, value, parent, key) {\n  var errors = [];\n  var value = Property.create(typeOrConfig, value || {}, parent, key, errors).value;\n  if (errors.length) {\n    throw new InitError(value, errors);\n  } else {\n    return value;\n  }\n}\nexport function register(type, config) {\n  return Property.registerType(type, config);\n}\nexport function meta(obj, key) {\n  if (defined(obj) && obj[__sym]) {\n    return obj[__sym].meta(key);\n  } else {\n    return undefined;\n  }\n}"]}