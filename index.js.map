{"version":3,"sources":["src/index.js"],"names":[],"mappings":"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","file":"index.js","sourcesContent":["'use strict';\n\nvar __sym = Symbol();\n\nfunction defined(v) {\n   return typeof v !== 'undefined';\n}\n\nclass DataError extends Error {\n  constructor(name, path) {\n    super(name);\n    this.path = path;\n  }\n}\n\nclass Property {\n  constructor(config, value) {\n    this.config = Property.getConfig(config);\n    try {\n      this.setValue(value || this.config.default);\n    } catch(e) {}\n  }\n  attach(parent, key) {\n    this.detach();\n    if (defined(parent) && defined(key)) {\n      this.parent = parent;\n      this.key = key;\n      Object.defineProperty(this.parent, this.key, {\n        configurable: !this.config.required,\n        enumerable: true,\n        get: this.getter(),\n        set: this.setter()\n      });\n    }\n  }\n  detach() {\n    if (defined(this.key) && defined(this.parent)) {\n      delete this.parent[this.key];\n    }\n    delete this.key;\n    delete this.parent;\n  }\n  check(v) {\n    if (!defined(v) && this.config.required) throw new DataError('required', this.getPath());\n    if (this.config.validator && !this.config.validator(v)) throw new DataError('validator', this.getPath());\n  }\n  init(v) {\n    this.check(v);\n  }\n  getter() {\n    var f = this.getValue.bind(this);\n    f.config = this.config;\n    return f;\n  }\n  getValue() {\n    this.check(this.value);\n    return this.value;\n  }\n  setter() {\n    var f = this.setValue.bind(this);\n    f.config = this.config;\n    return f;\n  }\n  setValue(v) {\n    this.init(v);\n    return this.value = v;\n  }\n  getPath() {\n    var p = '';\n    if (this.parent && this.key) {\n      if (this.parent[__sym]) {\n        p = this.parent[__sym].getPath();\n      }\n      p += (p ? '.' : '') + this.key;\n    }\n    return p;\n  }\n  meta(key) {\n    if (key) {\n      var desc = Object.getOwnPropertyDescriptor(this.value, key);\n      return ((desc || {}).get || {}).config;\n    } else {\n      return this.config;\n    }\n  }\n  static registerType(type, config) {\n    if (!Property.types) Property.types = {};\n    config.name = type;\n    Property.types[type] = config;\n  }\n  static getConfig(typeOrConfig) {\n    if (!Property.types) Property.types = {};\n    var config = null;\n    if (typeOrConfig) {\n      if (typeof typeOrConfig === 'string') {\n        config = Property.types[typeOrConfig];\n      } else if (typeof typeOrConfig === 'object') {\n        config = typeOrConfig;\n      }\n    }\n    if (!config) throw new Error('bad_config');\n    return config;\n  }\n  static create(typeOrConfig, value) {\n    var factories = {\n      \"string\": StringProperty,\n      \"number\": NumberProperty,\n      \"boolean\": BooleanProperty,\n      \"array\": ArrayProperty,\n      \"date\": DateProperty,\n      \"select\": SelectProperty,\n      \"object\": ObjectProperty\n    };\n    var config = Property.getConfig(typeOrConfig);\n    if (!factories[config.type]) throw new Error('bad_type');\n    return new factories[config.type](config, value);\n  }\n}\n\nclass StringProperty extends Property {\n  constructor(config, value) {\n    super(config, value);\n    if (defined(this.config.pattern)) {\n      if (typeof this.config.pattern === 'string') {\n        this.config.pattern = new RegExp(this.config.pattern);\n      } else if (!(this.config.patten instanceof RegExp)) {\n        throw new Error('bad_pattern');\n      }\n    }\n  }\n  check(v) {\n    if (defined(v) && typeof v !== 'string') throw new DataError('type', this.getPath());\n    super.check(v);\n    if (defined(v)) {\n      if (defined(this.config.minLength) && v.length < +this.config.minLength) throw new DataError('minLength', this.getPath());\n      if (defined(this.config.maxLength) && v.length > +this.config.maxLength) throw new DataError('maxLength', this.getPath());\n      if (defined(this.config.pattern) && !this.config.pattern.test(v)) throw new DataError('pattern', this.getPath());\n    }\n  }\n}\n\nclass NumberProperty extends Property {\n  constructor(config, value) {\n    super(config, value);\n  }\n  check(v) {\n    if (defined(v) && typeof v !== 'number') throw new DataError('type', this.getPath());\n    super.check(v);\n    if (defined(v)) {\n      if (defined(this.config.min) && !(v >= +this.config.min)) throw new DataError('min', this.getPath());\n      if (defined(this.config.max) && !(v <= +this.config.max)) throw new DataError('max', this.getPath());\n    }\n  }\n}\n\nclass BooleanProperty extends Property {\n  constructor(config, value) {\n    super(config, value);\n  }\n  check(v) {\n    if (defined(v) && typeof v !== 'boolean') throw new DataError('type', this.getPath());\n    super.check(v);\n  }\n}\n\nclass ArrayProperty extends Property {\n  constructor(config, value) {\n    super(config, value);\n    this.config.value = Property.getConfig(this.config.value);\n  }\n  init(v) {\n    this.check(v);\n    if (!defined(v) || v[__sym] === this) return;\n    for (var i = 0, p ; i < v.length ; i++) {\n      p = Property.create(this.config.value, v[i]);\n      if (p) p.attach(v, i);\n    }\n    v.push = (...args) => {\n      for (var i = 0 ; i < args.length ; i++) {\n        p = Property.create(this.config.value, args[i]);\n        if (p) p.attach(v, v.length);\n      }\n    }\n    v[__sym] = this;\n  }\n  check(v) {\n    if (defined(v) && typeof v !== 'object' && !(v instanceof Array)) throw new DataError('type', this.getPath());\n    super.check(v);\n    if (defined(v)) {\n      if (defined(this.config.minLength) && v.length < +this.config.minLength) throw new DataError('minLength', this.getPath());\n      if (defined(this.config.maxLength) && v.length > +this.config.maxLength) throw new DataError('maxLength', this.getPath());\n    }\n  }\n}\n\nclass DateProperty extends Property {\n  constructor(config, value) {\n    super(config, value);\n  }\n  setValue(v) {\n    var _v = v;\n    if (defined(_v) && !(_v instanceof Date)) _v = new Date(v);\n    super.setValue(v);\n  }\n}\n\nclass SelectProperty extends Property {\n  constructor(config, value) {\n    super(config, value);\n    if (!(this.config.value instanceof Array) || !this.config.value.length) throw new Error('bad_value');\n  }\n  check(v) {\n    super.check(v);\n    if (this.config.value.indexOf(v) === -1) throw new DataError('value', this.getPath());\n  }\n}\n\nclass ObjectProperty extends Property {\n  constructor(config, value) {\n    super(config, value);\n  }\n  init(v) {\n    this.check(v);\n    if (!defined(v) || v[__sym] === this) return;\n    var k, p, sub = this.config.value || {};\n    for (k in sub) {\n      sub[k] = Property.getConfig(sub[k]);\n      p = Property.create(sub[k], v[k]);\n      if (p) p.attach(v, k);\n    }\n    v[__sym] = this;\n  }\n  check(v) {\n    if (defined(v) && typeof v !== 'object') throw new DataError('type', this.getPath());\n    super.check(v);\n  }\n}\n\nexport function create(typeOrConfig, value) {\n  return Property.create(typeOrConfig, value || {}).value;\n}\nexport function register(type, config) {\n  return Property.registerType(type, config);\n}\nexport function meta(obj, key) {\n  if (defined(obj) && obj[__sym]) {\n    return obj[__sym].meta(key);\n  } else {\n    return undefined;\n  }\n}"]}